<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Firebase on メモ帳</title><link>/tags/firebase/</link><description>Recent content in Firebase on メモ帳</description><generator>Hugo -- gohugo.io</generator><language>ja-jp</language><lastBuildDate>Wed, 29 Aug 2018 00:00:00 +0000</lastBuildDate><atom:link href="/tags/firebase/index.xml" rel="self" type="application/rss+xml"/><item><title>FirebaseでID Tokenを生成する</title><link>/post/firebase%E3%81%A7id-token%E3%82%92%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B/</link><pubDate>Wed, 29 Aug 2018 00:00:00 +0000</pubDate><guid>/post/firebase%E3%81%A7id-token%E3%82%92%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B/</guid><description>
FirebaseでID Tokenを生成する方法です．
Firebase Functionsで認証の仕組みを使った時にこれフロント作らないとデバッグ出来ないのか…？みたいな気持ちになったので生成方法メモしておきます．
必要なもの ウェブ API キー
プロジェクトの設定の全般から取得できます サービスアカウントの認証情報
プロジェクトの設定のサービスアカウントから新しい秘密鍵の生成で持ってこれます ログインしたいユーザーのuid
プロジェクトのAuthenticationのユーザーuidから持ってきます Functionsはこんな感じのなんか認証情報でアクセス許可したりしなかったりする感じ
1app.use((req, res, next) =&amp;gt; { 2const idToken = req.headers.authorization.replace(&amp;#34;Bearer &amp;#34;, &amp;#34;&amp;#34;); 3const decodedToken = await admin.auth().verifyIdToken(idToken); 4if (よしなに判定){ 5// 認証失敗 6 res.status(401).send(&amp;#34;認証いるよ&amp;#34;); 7} else { 8next(); 9} 10}); ここでBearerヘッダに入れるidTokenってどうやって入手するの…？となるわけですがフロントがあるなら
ログイン認証後に
1const idtoken = await firebase.auth().currentUser.getIdToken(); とかやると取れます（多分
ただフロントは今回全く書いてなかったので使わずに生成する方法です．
まずカスタムトークンが必要になるのでこれを生成します．
https://firebase.google.com/docs/auth/admin/create-custom-tokens?hl=ja
この辺に各言語でのやり方が書いてありますが今回はPythonで説明します．
以下のようなコードを使います．
必要部分は事前に取得したもので埋めて下さい．
1import firebase_admin 2from firebase_admin import credentials 3from firebase_admin import auth 45# 管理コンソールのサービスアカウントから取得する 6cred = credentials.</description></item><item><title>firebase loginをauthorization codeでする</title><link>/post/firebase-login%E3%82%92authorization-code%E3%81%A7%E3%81%99%E3%82%8B/</link><pubDate>Wed, 15 Aug 2018 00:00:00 +0000</pubDate><guid>/post/firebase-login%E3%82%92authorization-code%E3%81%A7%E3%81%99%E3%82%8B/</guid><description>
SSHしてるリモート上でfirebase loginしようとしたらログイン後のコールバックがlocalhostになってるので認証出来ず困ったのでそのメモ
オプションに--no-localhostをつけるとコードベースで認証できる
表示されたURLを適当なマシンで開いてアカウントの認証を済ませるとブラウザ上で認証用のコードが表示されるのでコンソールに貼り付けて終わり
1$ firebase login --no-localhost 2? Allow Firebase to collect anonymous CLI usage and error reporting information? No 34Visit this URL on any device to log in: 5https://accounts.google.com/o/oauth2/auth[省略] 67? Paste authorization code here: [ブラウザに表示されたコードを貼り付ける] 89✔ Success! Logged in as [username]@gmail.com 参考記事 Stackoverflow How to login to firebase-tools on headless remote server?</description></item></channel></rss>